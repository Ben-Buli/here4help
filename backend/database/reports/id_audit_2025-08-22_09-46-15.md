# ID/FK 類型審計報告

**審計日期**: 2025-08-22 09:46:15
**資料庫**: hero4helpdemofhs_hero4help

## 📊 摘要

| 優先級 | 問題數量 |
|--------|----------|
| 高 | 0 |
| 中 | 27 |
| 低 | 25 |
| **總計** | **52** |

## 🚨 發現的問題

### 1. 🟡 多個表格使用不同的主鍵類型，建議統一使用 BIGINT UNSIGNED AUTO_INCREMENT

- **類型**: primary_key_inconsistency
- **嚴重程度**: medium

### 2. 🟡 多個表格使用不同的主鍵類型，建議統一使用 BIGINT UNSIGNED AUTO_INCREMENT

- **類型**: primary_key_inconsistency
- **嚴重程度**: medium

### 3. 🟡 主鍵 ID 不是 BIGINT 類型，可能在大量數據時溢出

- **類型**: primary_key_not_bigint
- **嚴重程度**: medium
- **表格**: admin_activity_logs
- **欄位**: id

### 4. 🟡 主鍵 ID 不是 BIGINT 類型，可能在大量數據時溢出

- **類型**: primary_key_not_bigint
- **嚴重程度**: medium
- **表格**: admin_login_logs
- **欄位**: id

### 5. 🟡 主鍵 ID 不是 BIGINT 類型，可能在大量數據時溢出

- **類型**: primary_key_not_bigint
- **嚴重程度**: medium
- **表格**: admins
- **欄位**: id

### 6. 🟡 主鍵 ID 不是 BIGINT 類型，可能在大量數據時溢出

- **類型**: primary_key_not_bigint
- **嚴重程度**: medium
- **表格**: application_questions
- **欄位**: id

### 7. 🟢 外鍵使用 VARCHAR 類型，建議檢查是否應為數值類型

- **類型**: varchar_foreign_key
- **嚴重程度**: low
- **表格**: application_questions
- **欄位**: task_id

### 8. 🟡 主鍵 ID 不是 BIGINT 類型，可能在大量數據時溢出

- **類型**: primary_key_not_bigint
- **嚴重程度**: medium
- **表格**: application_questions_backup_20250111
- **欄位**: id

### 9. 🟢 外鍵使用 VARCHAR 類型，建議檢查是否應為數值類型

- **類型**: varchar_foreign_key
- **嚴重程度**: low
- **表格**: application_questions_backup_20250111
- **欄位**: task_id

### 10. 🟡 主鍵 ID 不是 BIGINT 類型，可能在大量數據時溢出

- **類型**: primary_key_not_bigint
- **嚴重程度**: medium
- **表格**: application_questions_backup_fill_20250111
- **欄位**: id

### 11. 🟢 外鍵使用 VARCHAR 類型，建議檢查是否應為數值類型

- **類型**: varchar_foreign_key
- **嚴重程度**: low
- **表格**: application_questions_backup_fill_20250111
- **欄位**: task_id

### 12. 🟡 主鍵 ID 不是 BIGINT 類型，可能在大量數據時溢出

- **類型**: primary_key_not_bigint
- **嚴重程度**: medium
- **表格**: application_questions_backup_seed_20250111
- **欄位**: id

### 13. 🟢 外鍵使用 VARCHAR 類型，建議檢查是否應為數值類型

- **類型**: varchar_foreign_key
- **嚴重程度**: low
- **表格**: application_questions_backup_seed_20250111
- **欄位**: task_id

### 14. 🟢 外鍵使用 VARCHAR 類型，建議檢查是否應為數值類型

- **類型**: varchar_foreign_key
- **嚴重程度**: low
- **表格**: chat_rooms
- **欄位**: task_id

### 15. 🟢 外鍵使用 VARCHAR 類型，建議檢查是否應為數值類型

- **類型**: varchar_foreign_key
- **嚴重程度**: low
- **表格**: chat_rooms_backup_20250111
- **欄位**: task_id

### 16. 🟡 主鍵 ID 不是 BIGINT 類型，可能在大量數據時溢出

- **類型**: primary_key_not_bigint
- **嚴重程度**: medium
- **表格**: discarded_support_chat_messages
- **欄位**: id

### 17. 🟡 主鍵 ID 不是 BIGINT 類型，可能在大量數據時溢出

- **類型**: primary_key_not_bigint
- **嚴重程度**: medium
- **表格**: discarded_support_chat_rooms
- **欄位**: id

### 18. 🟢 外鍵使用 VARCHAR 類型，建議檢查是否應為數值類型

- **類型**: varchar_foreign_key
- **嚴重程度**: low
- **表格**: dispute_chats
- **欄位**: task_id

### 19. 🟡 主鍵 ID 不是 BIGINT 類型，可能在大量數據時溢出

- **類型**: primary_key_not_bigint
- **嚴重程度**: medium
- **表格**: job_batches
- **欄位**: id

### 20. 🟡 主鍵 ID 不是 BIGINT 類型，可能在大量數據時溢出

- **類型**: primary_key_not_bigint
- **嚴重程度**: medium
- **表格**: languages
- **欄位**: id

### 21. 🟡 主鍵 ID 不是 BIGINT 類型，可能在大量數據時溢出

- **類型**: primary_key_not_bigint
- **嚴重程度**: medium
- **表格**: migrations
- **欄位**: id

### 22. 🟢 外鍵使用 VARCHAR 類型，建議檢查是否應為數值類型

- **類型**: varchar_foreign_key
- **嚴重程度**: low
- **表格**: oauth_temp_users
- **欄位**: provider_user_id

### 23. 🟡 主鍵 ID 不是 BIGINT 類型，可能在大量數據時溢出

- **類型**: primary_key_not_bigint
- **嚴重程度**: medium
- **表格**: order_items
- **欄位**: id

### 24. 🟡 主鍵 ID 不是 BIGINT 類型，可能在大量數據時溢出

- **類型**: primary_key_not_bigint
- **嚴重程度**: medium
- **表格**: orders
- **欄位**: id

### 25. 🟡 主鍵 ID 不是 BIGINT 類型，可能在大量數據時溢出

- **類型**: primary_key_not_bigint
- **嚴重程度**: medium
- **表格**: point_deposit_requests
- **欄位**: id

### 26. 🟡 主鍵 ID 不是 BIGINT 類型，可能在大量數據時溢出

- **類型**: primary_key_not_bigint
- **嚴重程度**: medium
- **表格**: referral_codes
- **欄位**: id

### 27. 🟢 外鍵使用 VARCHAR 類型，建議檢查是否應為數值類型

- **類型**: varchar_foreign_key
- **嚴重程度**: low
- **表格**: student_verifications
- **欄位**: student_id

### 28. 🟡 主鍵 ID 不是 BIGINT 類型，可能在大量數據時溢出

- **類型**: primary_key_not_bigint
- **嚴重程度**: medium
- **表格**: task_activity_logs_legacy_20250820
- **欄位**: id

### 29. 🟢 外鍵使用 VARCHAR 類型，建議檢查是否應為數值類型

- **類型**: varchar_foreign_key
- **嚴重程度**: low
- **表格**: task_activity_logs_legacy_20250820
- **欄位**: task_id

### 30. 🟢 外鍵使用 VARCHAR 類型，建議檢查是否應為數值類型

- **類型**: varchar_foreign_key
- **嚴重程度**: low
- **表格**: task_applications
- **欄位**: task_id

### 31. 🟢 外鍵使用 VARCHAR 類型，建議檢查是否應為數值類型

- **類型**: varchar_foreign_key
- **嚴重程度**: low
- **表格**: task_applications_backup_20250111
- **欄位**: task_id

### 32. 🟢 外鍵使用 VARCHAR 類型，建議檢查是否應為數值類型

- **類型**: varchar_foreign_key
- **嚴重程度**: low
- **表格**: task_applications_backup_fill_20250111
- **欄位**: task_id

### 33. 🟢 外鍵使用 VARCHAR 類型，建議檢查是否應為數值類型

- **類型**: varchar_foreign_key
- **嚴重程度**: low
- **表格**: task_applications_backup_seed_20250111
- **欄位**: task_id

### 34. 🟡 主鍵 ID 不是 BIGINT 類型，可能在大量數據時溢出

- **類型**: primary_key_not_bigint
- **嚴重程度**: medium
- **表格**: task_dispute_chat_messages
- **欄位**: id

### 35. 🟡 主鍵 ID 不是 BIGINT 類型，可能在大量數據時溢出

- **類型**: primary_key_not_bigint
- **嚴重程度**: medium
- **表格**: task_dispute_chat_rooms
- **欄位**: id

### 36. 🟢 外鍵使用 VARCHAR 類型，建議檢查是否應為數值類型

- **類型**: varchar_foreign_key
- **嚴重程度**: low
- **表格**: task_dispute_chat_rooms
- **欄位**: task_id

### 37. 🟢 外鍵使用 VARCHAR 類型，建議檢查是否應為數值類型

- **類型**: varchar_foreign_key
- **嚴重程度**: low
- **表格**: task_disputes
- **欄位**: task_id

### 38. 🟢 外鍵使用 VARCHAR 類型，建議檢查是否應為數值類型

- **類型**: varchar_foreign_key
- **嚴重程度**: low
- **表格**: task_favorites
- **欄位**: task_id

### 39. 🟢 外鍵使用 VARCHAR 類型，建議檢查是否應為數值類型

- **類型**: varchar_foreign_key
- **嚴重程度**: low
- **表格**: task_logs
- **欄位**: task_id

### 40. 🟢 外鍵使用 VARCHAR 類型，建議檢查是否應為數值類型

- **類型**: varchar_foreign_key
- **嚴重程度**: low
- **表格**: task_ratings
- **欄位**: task_id

### 41. 🟢 外鍵使用 VARCHAR 類型，建議檢查是否應為數值類型

- **類型**: varchar_foreign_key
- **嚴重程度**: low
- **表格**: task_reports
- **欄位**: task_id

### 42. 🟢 外鍵使用 VARCHAR 類型，建議檢查是否應為數值類型

- **類型**: varchar_foreign_key
- **嚴重程度**: low
- **表格**: task_status_logs_legacy_20250820
- **欄位**: task_id

### 43. 🟡 主鍵 ID 不是 BIGINT 類型，可能在大量數據時溢出

- **類型**: primary_key_not_bigint
- **嚴重程度**: medium
- **表格**: task_statuses
- **欄位**: id

### 44. 🟡 主鍵 ID 不是 BIGINT 類型，可能在大量數據時溢出

- **類型**: primary_key_not_bigint
- **嚴重程度**: medium
- **表格**: tasks
- **欄位**: id

### 45. 🟢 外鍵使用 VARCHAR 類型，建議檢查是否應為數值類型

- **類型**: varchar_foreign_key
- **嚴重程度**: low
- **表格**: tasks_backup
- **欄位**: acceptor_id

### 46. 🟡 主鍵 ID 不是 BIGINT 類型，可能在大量數據時溢出

- **類型**: primary_key_not_bigint
- **嚴重程度**: medium
- **表格**: tasks_backup
- **欄位**: id

### 47. 🟡 主鍵 ID 不是 BIGINT 類型，可能在大量數據時溢出

- **類型**: primary_key_not_bigint
- **嚴重程度**: medium
- **表格**: tasks_backup_20250809
- **欄位**: id

### 48. 🟡 主鍵 ID 不是 BIGINT 類型，可能在大量數據時溢出

- **類型**: primary_key_not_bigint
- **嚴重程度**: medium
- **表格**: universities
- **欄位**: id

### 49. 🟢 外鍵使用 VARCHAR 類型，建議檢查是否應為數值類型

- **類型**: varchar_foreign_key
- **嚴重程度**: low
- **表格**: user_identities
- **欄位**: provider_user_id

### 50. 🟡 主鍵 ID 不是 BIGINT 類型，可能在大量數據時溢出

- **類型**: primary_key_not_bigint
- **嚴重程度**: medium
- **表格**: user_verification_rejections
- **欄位**: id

### 51. 🟢 外鍵使用 VARCHAR 類型，建議檢查是否應為數值類型

- **類型**: varchar_foreign_key
- **嚴重程度**: low
- **表格**: v_task_activity_logs
- **欄位**: task_id

### 52. 🟢 外鍵使用 VARCHAR 類型，建議檢查是否應為數值類型

- **類型**: varchar_foreign_key
- **嚴重程度**: low
- **表格**: v_task_status_logs
- **欄位**: task_id

## 🔧 遷移計劃

### 1. 🔴 升級主鍵為 BIGINT

- **表格**: admin_activity_logs
- **風險等級**: high
- **SQL**: 
```sql
ALTER TABLE `admin_activity_logs` MODIFY COLUMN `id` BIGINT UNSIGNED AUTO_INCREMENT;
```

### 2. 🔴 升級主鍵為 BIGINT

- **表格**: admin_login_logs
- **風險等級**: high
- **SQL**: 
```sql
ALTER TABLE `admin_login_logs` MODIFY COLUMN `id` BIGINT UNSIGNED AUTO_INCREMENT;
```

### 3. 🔴 升級主鍵為 BIGINT

- **表格**: admins
- **風險等級**: high
- **SQL**: 
```sql
ALTER TABLE `admins` MODIFY COLUMN `id` BIGINT UNSIGNED AUTO_INCREMENT;
```

### 4. 🔴 升級主鍵為 BIGINT

- **表格**: application_questions
- **風險等級**: high
- **SQL**: 
```sql
ALTER TABLE `application_questions` MODIFY COLUMN `id` BIGINT UNSIGNED AUTO_INCREMENT;
```

### 5. 🔴 升級主鍵為 BIGINT

- **表格**: application_questions_backup_20250111
- **風險等級**: high
- **SQL**: 
```sql
ALTER TABLE `application_questions_backup_20250111` MODIFY COLUMN `id` BIGINT UNSIGNED AUTO_INCREMENT;
```

### 6. 🔴 升級主鍵為 BIGINT

- **表格**: application_questions_backup_fill_20250111
- **風險等級**: high
- **SQL**: 
```sql
ALTER TABLE `application_questions_backup_fill_20250111` MODIFY COLUMN `id` BIGINT UNSIGNED AUTO_INCREMENT;
```

### 7. 🔴 升級主鍵為 BIGINT

- **表格**: application_questions_backup_seed_20250111
- **風險等級**: high
- **SQL**: 
```sql
ALTER TABLE `application_questions_backup_seed_20250111` MODIFY COLUMN `id` BIGINT UNSIGNED AUTO_INCREMENT;
```

### 8. 🔴 升級主鍵為 BIGINT

- **表格**: discarded_support_chat_messages
- **風險等級**: high
- **SQL**: 
```sql
ALTER TABLE `discarded_support_chat_messages` MODIFY COLUMN `id` BIGINT UNSIGNED AUTO_INCREMENT;
```

### 9. 🔴 升級主鍵為 BIGINT

- **表格**: discarded_support_chat_rooms
- **風險等級**: high
- **SQL**: 
```sql
ALTER TABLE `discarded_support_chat_rooms` MODIFY COLUMN `id` BIGINT UNSIGNED AUTO_INCREMENT;
```

### 10. 🔴 升級主鍵為 BIGINT

- **表格**: job_batches
- **風險等級**: high
- **SQL**: 
```sql
ALTER TABLE `job_batches` MODIFY COLUMN `id` BIGINT UNSIGNED AUTO_INCREMENT;
```

### 11. 🔴 升級主鍵為 BIGINT

- **表格**: languages
- **風險等級**: high
- **SQL**: 
```sql
ALTER TABLE `languages` MODIFY COLUMN `id` BIGINT UNSIGNED AUTO_INCREMENT;
```

### 12. 🔴 升級主鍵為 BIGINT

- **表格**: migrations
- **風險等級**: high
- **SQL**: 
```sql
ALTER TABLE `migrations` MODIFY COLUMN `id` BIGINT UNSIGNED AUTO_INCREMENT;
```

### 13. 🔴 升級主鍵為 BIGINT

- **表格**: order_items
- **風險等級**: high
- **SQL**: 
```sql
ALTER TABLE `order_items` MODIFY COLUMN `id` BIGINT UNSIGNED AUTO_INCREMENT;
```

### 14. 🔴 升級主鍵為 BIGINT

- **表格**: orders
- **風險等級**: high
- **SQL**: 
```sql
ALTER TABLE `orders` MODIFY COLUMN `id` BIGINT UNSIGNED AUTO_INCREMENT;
```

### 15. 🔴 升級主鍵為 BIGINT

- **表格**: point_deposit_requests
- **風險等級**: high
- **SQL**: 
```sql
ALTER TABLE `point_deposit_requests` MODIFY COLUMN `id` BIGINT UNSIGNED AUTO_INCREMENT;
```

### 16. 🔴 升級主鍵為 BIGINT

- **表格**: referral_codes
- **風險等級**: high
- **SQL**: 
```sql
ALTER TABLE `referral_codes` MODIFY COLUMN `id` BIGINT UNSIGNED AUTO_INCREMENT;
```

### 17. 🔴 升級主鍵為 BIGINT

- **表格**: task_activity_logs_legacy_20250820
- **風險等級**: high
- **SQL**: 
```sql
ALTER TABLE `task_activity_logs_legacy_20250820` MODIFY COLUMN `id` BIGINT UNSIGNED AUTO_INCREMENT;
```

### 18. 🔴 升級主鍵為 BIGINT

- **表格**: task_dispute_chat_messages
- **風險等級**: high
- **SQL**: 
```sql
ALTER TABLE `task_dispute_chat_messages` MODIFY COLUMN `id` BIGINT UNSIGNED AUTO_INCREMENT;
```

### 19. 🔴 升級主鍵為 BIGINT

- **表格**: task_dispute_chat_rooms
- **風險等級**: high
- **SQL**: 
```sql
ALTER TABLE `task_dispute_chat_rooms` MODIFY COLUMN `id` BIGINT UNSIGNED AUTO_INCREMENT;
```

### 20. 🔴 升級主鍵為 BIGINT

- **表格**: task_statuses
- **風險等級**: high
- **SQL**: 
```sql
ALTER TABLE `task_statuses` MODIFY COLUMN `id` BIGINT UNSIGNED AUTO_INCREMENT;
```

### 21. 🔴 升級主鍵為 BIGINT

- **表格**: tasks
- **風險等級**: high
- **SQL**: 
```sql
ALTER TABLE `tasks` MODIFY COLUMN `id` BIGINT UNSIGNED AUTO_INCREMENT;
```

### 22. 🔴 升級主鍵為 BIGINT

- **表格**: tasks_backup
- **風險等級**: high
- **SQL**: 
```sql
ALTER TABLE `tasks_backup` MODIFY COLUMN `id` BIGINT UNSIGNED AUTO_INCREMENT;
```

### 23. 🔴 升級主鍵為 BIGINT

- **表格**: tasks_backup_20250809
- **風險等級**: high
- **SQL**: 
```sql
ALTER TABLE `tasks_backup_20250809` MODIFY COLUMN `id` BIGINT UNSIGNED AUTO_INCREMENT;
```

### 24. 🔴 升級主鍵為 BIGINT

- **表格**: universities
- **風險等級**: high
- **SQL**: 
```sql
ALTER TABLE `universities` MODIFY COLUMN `id` BIGINT UNSIGNED AUTO_INCREMENT;
```

### 25. 🔴 升級主鍵為 BIGINT

- **表格**: user_verification_rejections
- **風險等級**: high
- **SQL**: 
```sql
ALTER TABLE `user_verification_rejections` MODIFY COLUMN `id` BIGINT UNSIGNED AUTO_INCREMENT;
```

## 📋 建議

1. **備份資料庫**: 在執行任何遷移之前，請先完整備份資料庫
2. **測試環境**: 先在測試環境執行遷移腳本
3. **分階段執行**: 按優先級分階段執行遷移
4. **監控性能**: 遷移後監控查詢性能變化
5. **更新應用程式**: 確保應用程式代碼與新的資料類型相容

