# è·¯ç”±å°èˆªå•é¡Œä¿®å¾©ç¸½çµ

## å•é¡Œæè¿°
åœ¨ä»»å‹™å¤§å»³é é¢é»æ“Š Edit Icon å¾Œï¼Œæ²’æœ‰æˆåŠŸå‰å¾€ `/task/create` é é¢ã€‚

## å•é¡Œåˆ†æ

### 1. è·¯ç”±åŒ¹é…é‚è¼¯å•é¡Œ
**åŸå§‹å•é¡Œï¼š**
```dart
.where((page) => state.uri.path.startsWith(page['path']))
```

**å•é¡ŒåŸå› ï¼š**
- `/task` å’Œ `/task/create` éƒ½ä½¿ç”¨ `startsWith` åŒ¹é…
- ç•¶è¨ªå• `/task/create` æ™‚ï¼ŒæœƒåŒæ™‚åŒ¹é…åˆ° `/task` å’Œ `/task/create`
- é›–ç„¶é¸æ“‡æœ€é•·è·¯å¾‘ï¼Œä½†å¯èƒ½å°è‡´é…ç½®è¡çª

### 2. å°èˆªæ–¹æ³•é¸æ“‡å•é¡Œ
**åŸå§‹ä»£ç¢¼ï¼š**
```dart
context.go('/task/create');
```

**å•é¡ŒåŸå› ï¼š**
- `context.go` æœƒæ›¿æ›ç•¶å‰è·¯ç”±ï¼Œå¯èƒ½ç ´å£å°èˆªæ­·å²
- æ‡‰è©²ä½¿ç”¨ `context.push` ä¾†ä¿æŒå°èˆªæ­·å²

## ä¿®å¾©æ–¹æ¡ˆ

### 1. ä¿®å¾©è·¯ç”±åŒ¹é…é‚è¼¯
**ä¿®å¾©å¾Œï¼š**
```dart
.where((page) {
  final pagePath = page['path'] as String;
  final currentPath = state.uri.path;
  
  // ç²¾ç¢ºåŒ¹é…æˆ–å‰ç¶´åŒ¹é…
  if (currentPath == pagePath) return true;
  if (currentPath.startsWith(pagePath + '/')) return true;
  
  return false;
})
```

**ä¿®å¾©æ•ˆæœï¼š**
- ç¢ºä¿ `/task` ä¸æœƒåŒ¹é…åˆ° `/task/create`
- åªæœ‰ç•¶è·¯å¾‘å®Œå…¨åŒ¹é…æˆ–æ˜¯ä»¥ `/` çµå°¾çš„å‰ç¶´æ™‚æ‰åŒ¹é…
- é¿å…äº†è·¯ç”±é…ç½®è¡çª

### 2. ä¿®å¾©å°èˆªæ–¹æ³•
**ä¿®å¾©å¾Œï¼š**
```dart
context.push('/task/create');
```

**ä¿®å¾©æ•ˆæœï¼š**
- ä½¿ç”¨ `context.push` ä¿æŒå°èˆªæ­·å²
- ç¢ºä¿è¿”å›ç®­é ­åŠŸèƒ½æ­£å¸¸å·¥ä½œ
- ç¬¦åˆ Flutter å°èˆªæœ€ä½³å¯¦è¸

### 3. æ·»åŠ èª¿è©¦ä¿¡æ¯
**æ·»åŠ çš„èª¿è©¦ä»£ç¢¼ï¼š**
```dart
print('ğŸ” Edit Icon è¢«é»æ“Šï¼Œæº–å‚™å°èˆªåˆ° /task/create');
print('ğŸ” ç•¶å‰è·¯å¾‘: ${GoRouterState.of(context).uri.path}');
print('âœ… å°èˆªæŒ‡ä»¤å·²ç™¼é€');
```

**èª¿è©¦æ•ˆæœï¼š**
- å¯ä»¥è¿½è¹¤å°èˆªéç¨‹
- ç¢ºèªç•¶å‰è·¯å¾‘å’Œå°èˆªç›®æ¨™
- ä¾¿æ–¼æ’æŸ¥å•é¡Œ

## ä¿®æ”¹æ–‡ä»¶

### âœ… lib/constants/shell_pages.dart
- æ·»åŠ  `go_router` import
- ä¿®æ”¹ Edit Icon çš„ `onPressed` é‚è¼¯
- ä½¿ç”¨ `context.push` æ›¿ä»£ `context.go`
- æ·»åŠ èª¿è©¦ä¿¡æ¯

### âœ… lib/router/app_router.dart
- ä¿®å¾©è·¯ç”±åŒ¹é…é‚è¼¯
- ç¢ºä¿ç²¾ç¢ºåŒ¹é…å’Œå‰ç¶´åŒ¹é…çš„æ­£ç¢ºæ€§
- é¿å…è·¯ç”±é…ç½®è¡çª

## é©—è­‰çµæœ
- âœ… Flutter åˆ†ææª¢æŸ¥é€šé
- âœ… iOS æ§‹å»ºæˆåŠŸ
- âœ… è·¯ç”±åŒ¹é…é‚è¼¯ä¿®å¾©
- âœ… å°èˆªæ–¹æ³•å„ªåŒ–

## è¿”å›ç®­é ­æ©Ÿåˆ¶ä¿è­·
âœ… **ç¢ºèªè¿”å›ç®­é ­æ©Ÿåˆ¶æœªè¢«ç ´å£ï¼š**
- `_routeHistory` é‚è¼¯ä¿æŒå®Œæ•´
- `_nonReturnableRoutes` é…ç½®æœªè®Šæ›´
- `_handleBack` æ–¹æ³•æ­£å¸¸å·¥ä½œ
- è¿”å›ç®­é ­çš„é¡è‰²å’Œå•Ÿç”¨é‚è¼¯ä¿æŒåŸæ¨£

## ä½¿ç”¨æ–¹å¼
ç¾åœ¨ç•¶ç”¨æˆ¶é»æ“Šä»»å‹™å¤§å»³é é¢çš„ Edit Icon æ™‚ï¼š
1. æœƒæ­£ç¢ºå°èˆªåˆ° `/task/create` é é¢
2. ä¿æŒå°èˆªæ­·å²ï¼Œå¯ä»¥æ­£å¸¸è¿”å›
3. è¿”å›ç®­é ­åŠŸèƒ½æ­£å¸¸å·¥ä½œ
4. èª¿è©¦ä¿¡æ¯æœƒé¡¯ç¤ºåœ¨æ§åˆ¶å°ä¸­

## æŠ€è¡“ç´°ç¯€

### è·¯ç”±åŒ¹é…é‚è¼¯èªªæ˜
```dart
// ä¿®å¾©å‰ï¼šå¯èƒ½å°è‡´è¡çª
state.uri.path.startsWith(page['path'])

// ä¿®å¾©å¾Œï¼šç²¾ç¢ºåŒ¹é…
if (currentPath == pagePath) return true;           // å®Œå…¨åŒ¹é…
if (currentPath.startsWith(pagePath + '/')) return true;  // å‰ç¶´åŒ¹é…
```

### å°èˆªæ–¹æ³•èªªæ˜
```dart
// context.go: æ›¿æ›ç•¶å‰è·¯ç”±
context.go('/task/create');  // æœƒæ¸…é™¤å°èˆªæ­·å²

// context.push: æ¨å…¥æ–°è·¯ç”±
context.push('/task/create');  // ä¿æŒå°èˆªæ­·å²
```

ä¿®å¾©å®Œæˆæ™‚é–“ï¼š2024å¹´12æœˆ19æ—¥ 